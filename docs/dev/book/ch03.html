<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Chapter 3. Writing a own module</title><link rel="stylesheet" href="book.css" type="text/css" /><meta name="generator" content="DocBook XSL Stylesheets V1.72.0" /><link rel="start" href="index.html" title="PHProjekt 6.x Developer Documentation" /><link rel="up" href="index.html" title="PHProjekt 6.x Developer Documentation" /><link rel="prev" href="ch02s03.html" title="Database Abstraction" /><link rel="next" href="ch03s02.html" title="Create directories and files" /></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">Chapter 3. Writing a own module</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="ch02s03.html">Prev</a> </td><th width="60%" align="center"> </th><td width="20%" align="right"> <a accesskey="n" href="ch03s02.html">Next</a></td></tr></table><hr /></div><div class="chapter" lang="en-US" xml:lang="en-US"><div class="titlepage"><div><div><h2 class="title"><a id="id322636"></a>Chapter 3. Writing a own module</h2></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="sect1"><a href="ch03.html#id322681">Database table and Database Manager</a></span></dt><dt><span class="sect1"><a href="ch03s02.html">Create directories and files</a></span></dt><dd><dl><dt><span class="sect2"><a href="ch03s02.html#id322761">Model: Mapping</a></span></dt><dt><span class="sect2"><a href="ch03s02.html#id322866">View: Templates</a></span></dt></dl></dd><dt><span class="sect1"><a href="ch03s03.html">Tools</a></span></dt></dl></div><p>In the following chapter, we want to start writing code. We are going to write a mechanism to track our daily working hours. </p><p>We just want to have a button. If we click on the button, we start tracking the time. If we click another time, we stop tracking the time. Furthermore we want to display how many hours we worked this month and we want to select project to book our time on, before we start tracking.</p><p>We use the a SQL database to store our data. In particular we are going to use MySQL syntax. We also use <a href="http://smarty.php.net" target="_top">Smarty</a> templates to display our calculated times.</p><p>Our first step will be the creation of a database table that stores our data. After that we start creating the necessary directory structure for a module. Then we start writing code by creating a mapping from our database table into PHP. If we finished with that, we are going to design our frontend and then putting all together in the controller - catching the users actions.</p><p>Before we start, please consider to read the <span class="emphasis"><em>Zend Coding Guidelines</em></span> first. We are using some shortcuts that you should probably avoid in your module (we will left out a lot of the necessary documentation headers).</p><div class="sect1" lang="en-US" xml:lang="en-US"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="id322681"></a>Database table and Database Manager</h2></div></div></div><p>The first thing that has to be done is creating our database tables. We use our favorite tool to create the following table<sup>[<a id="id322689" href="#ftn.id322689">3</a>]</sup>:</p><pre class="screen">
CREATE TABLE `WorkingHours` (
  `id`        INT NOT NULL AUTO_INCREMENT,
  `startDate` DATETIME NOT NULL,
  `endDate`   DATETIME NOT NULL,
  `projectId` INT,
  PRIMARY KEY(id),
  FOREIGN KEY(projectId)   -- don't use this part if you don't use mysql with innodb
   REFERENCES project(id) 
    ON DELETE SET NULL
);
</pre><p>Thats everthing we need from our database. Let's pass over and create our necessary files.</p></div><div class="footnotes"><br /><hr width="100" align="left" /><div class="footnote"><p><sup>[<a id="ftn.id322689" href="#id322689">3</a>] </sup>We are using foreign keys here. If you use MySQL, make sure that PHProjekt was installed using InnoDB tables and that you create the example table using InnoDB (if necessary specifiy ENGINE=InnoDB)</p></div></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="ch02s03.html">Prev</a> </td><td width="20%" align="center"> </td><td width="40%" align="right"> <a accesskey="n" href="ch03s02.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">Database Abstraction </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top"> Create directories and files</td></tr></table></div></body></html>
