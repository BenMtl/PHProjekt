//>>built
require({cache:{"url:phpr/template/statisticsView.html":'<div class="statisticsView">\n    <ul class="buttons-outer">\n        <li data-dojo-attach-point="filterBtn" class="buttons-inner">\n            <img class="button" src="../../../img/timecard/icon-filter.png">\n        </li>\n        <li data-dojo-attach-point="monthViewGraphBtn" class="buttons-inner active">\n            <img src="../../../img/timecard/icon-graphics.png">\n        </li>\n        <li data-dojo-attach-point="monthViewTableBtn" class="buttons-inner">\n            <img src="../../../img/timecard/table-icon.png">\n        </li>\n    </ul>\n    <h2>Gearbeitete Zeit</h2>\n    <p>Die Anzahl der Stunden pro Tag und die erwartete Stundenanzahl</p>\n    <div class="filters" data-dojo-attach-point="filters">\n        <div class="filters-inner">\n            <h3>Filter</h3>\n            <div class="exportForm" data-dojo-attach-point="exportForm" data-dojo-type="dijit/form/Form">\n                <table><tbody>\n                    <tr>\n                        <td>Projekt:</td>\n                        <td>\n                            <div data-dojo-attach-point="projectChooserContainer"\n                                 data-dojo-type="dijit/layout/ContentPane"></div>\n                        </td>\n                    </tr>\n                    <tr>\n                        <td>Zeitraum:</td>\n                        <td>\n                            <input type="text"\n                                name="start"\n                                class="date"\n                                data-dojo-type="phpr/DateTextBox"\n                                data-dojo-attach-point="startDate"\n                                data-dojo-props="placeholder:\'Start date\', value: \'firstOfMonth\'" />\n                            -\n                            <input type="text"\n                                name="end"\n                                class="date"\n                                data-dojo-type="phpr/DateTextBox"\n                                data-dojo-attach-point="endDate"\n                                data-dojo-props="placeholder:\'End date\', value: \'lastOfMonth\'" />\n                        </td>\n                    </tr>\n                    <tr>\n                        <td></td>\n                        <td>\n                            <button data-dojo-type="dijit/form/Button"\n                                type="submit"\n                                data-dojo-attach-point="exportButton"\n                                data-dojo-props="baseClass:\'submitButton\'">Export to CSV</button>\n                        </td>\n                    </tr>\n                </tbody></table>\n            </div>\n        </div>\n    </div>\n    <div data-dojo-type="dijit/layout/ContentPane" data-dojo-attach-point="monthContainer">\n    </div>\n    <h2>Gearbeitete Zeit pro Projekt</h2>\n    <p>Die Anzahl der Stunden pro Projekt</p>\n    <div data-dojo-type="dijit/layout/ContentPane" data-dojo-attach-point="projectContainer">\n    </div>\n</div>\n'}});
define("phpr/StatisticsView","dojo/_base/declare,dojo/_base/lang,dojo/_base/array,dojo/dom-class,dojo/dom-construct,dojo/promise/all,dojo/json,dojo/io-query,dijit/_Widget,dijit/_TemplatedMixin,dijit/_WidgetsInTemplateMixin,dojo/text!phpr/template/statisticsView.html,dojo/on,dojo/Deferred,phpr/Statistics/WorktimeMonthGraph,phpr/Statistics/WorktimeMonthTable,phpr/ProjectChooser,phpr/models/Project,phpr/Timehelper,phpr/Statistics/ProjectUserTimeTable,dijit/layout/ContentPane".split(","),function(e,b,
h,d,i,j,k,l,m,n,o,p,c,q,r,s,t,f,g,u){var v=e([t],{createOptions:function(a){var b=new q,c=[],d=function(a){a&&c.push({id:""+a.id,name:""+a.id+" "+a.title,label:'<span class="projectId">'+a.id+"</span> "+a.title})};h.forEach(a.recent,d);0<a.recent.length&&c.push({label:"<hr/>"});c.push({id:"-1",name:"All",label:"All"});for(var e in a.projects)d(a.projects[e]);b.resolve(c);return b},getData:function(){return j({recent:f.getRecentProjects(),projects:f.getBookedProjects()})},postStoreSet:function(){this.set("value",
"-1")}});return e([m,n,o],{templateString:p,activeMonthWidget:null,monthState:"graph",projectChooser:null,_monthUpdateTimer:null,buildRendering:function(){this.inherited(arguments);this.projectChooser=new v({},i.create("select"));this.projectChooserContainer.set("content",this.projectChooser);this.own(c(this.monthViewGraphBtn,"click",b.hitch(this,"_onMonthViewGraph")));this.own(c(this.monthViewTableBtn,"click",b.hitch(this,"_onMonthViewTable")));this.own(c(this.filterBtn,"click",b.hitch(this,"_onFilter")));
this.own(c(this.projectChooser,"change",b.hitch(this,"_updateMonthWidget")));this.own(c(this.startDate,"change",b.hitch(this,"_updateMonthWidget")));this.own(c(this.endDate,"change",b.hitch(this,"_updateMonthWidget")));this.own(this.exportButton.on("click",b.hitch(this,this._openExport)))},_onMonthViewGraph:function(){d.remove(this.monthViewTableBtn,"active");d.add(this.monthViewGraphBtn,"active");this._setMonthGraph()},_onMonthViewTable:function(){d.add(this.monthViewTableBtn,"active");d.remove(this.monthViewGraphBtn,
"active");this._setMonthTable()},_setMonthTable:function(){this._destoyed||this._setMonthWidget(new s(this._getMonthWidgetOptions()),"table")},_setMonthGraph:function(){this._destoyed||this._setMonthWidget(new r(this._getMonthWidgetOptions()),"graph")},_setMonthWidget:function(a,b){if(null!==this.activeMonthWidget)this.activeMonthWidget.destroyRecursive(),this.activeMonthWidget=null;this.activeMonthWidget=a;this.monthContainer.set("content",this.activeMonthWidget);this.monthState=b},_setProjectTable:function(){var a=
this._getMonthWidgetOptions();this.projectContainer.set("content",new u({startDate:a.startDate,endDate:a.endDate}))},_getMonthWidgetOptions:function(){return{projects:this._getSelectedProjects(),startDate:this.startDate.get("value"),endDate:this.endDate.get("value")}},_getSelectedProjects:function(){var a=this.projectChooser.get("value");return"-1"===a||""===a?[]:[a]},_updateMonthWidget:function(){this._scheduleMonthWidgetUpdate()},_scheduleMonthWidgetUpdate:function(){clearTimeout(this._monthUpdateTimer);
this._monthUpdateTimer=setTimeout(b.hitch(this,function(){switch(this.monthState){case "table":this._setMonthTable();break;case "graph":this._setMonthGraph()}this._setProjectTable()}),250)},_openExport:function(a){a&&a.stopPropagation();if(this.exportForm.validate()){var a=this.exportForm.get("value"),b={format:"csv"};b.filter=k.stringify({startDatetime:{"!ge":g.jsDateToIsoDatetime(a.start),"!lt":g.jsDateToIsoDatetime(a.end)}});window.open("index.php/Timecard/Timecard/index?"+l.objectToQuery(b))}return!1},
_onFilter:function(){d.toggle(this.filters,"open")}})});