//>>built
define("phpr/Calendar","dojo/_base/declare,dojo/_base/array,dojo/dom-class,dojo/date,dojo/date/locale,dojo/when,dojo/date/stamp,dijit/Calendar,phpr/Api,phpr/Timehelper".split(","),function(l,h,f,i,m,n,d,o,j,p){function q(a,c){var b=d.toISOString(a,{selector:"date"});e.hasOwnProperty(b)?n(e[b],c):e[b]=j.getData("index.php/Calendar2/index/jsonHolidays",{query:{start:d.toISOString(a,{selector:"date"}),end:d.toISOString(i.add(a,"month",1),{selector:"date"})}}).then(function(a){a=h.filter(a,function(a){return"holiday"==
a.type});e[b]=a;c(a)},function(a){k||(k=!0,j.defaultErrorHandler(a))})}var e={},k=!1;return l([o],{_populateGrid:function(){this.inherited(arguments);var a,c=this._currentMonth(),b;for(b in this._date2cell)if(this._date2cell.hasOwnProperty(b)){a=this._date2cell[b];var g=new this.dateClassObj(a.dijitDateValue);m.isWeekend(g)&&g.getMonth()===c.getMonth()&&f.add(a,"weekend");0===i.compare(new Date,g,"date")&&f.add(a,"today")}this._highlightSpecialDays()},_highlightSpecialDays:function(){q(this._currentMonth(),
dojo.hitch(this,function(a){var c={};h.forEach(a,function(a){var b=p.datetimeToJsDate(a.date);c[d.toISOString(b,{selector:"date"})]=a});for(var b in this._date2cell)this._date2cell.hasOwnProperty(b)&&(a=new Date(parseInt(b,10)),c.hasOwnProperty(d.toISOString(a,{selector:"date"}))&&f.add(this._date2cell[b],"specialDay"))}))},_currentMonth:function(){var a=new this.dateClassObj(this.currentFocus);a.setDate(1);return a}})});