//>>built
require({cache:{"url:phpr/template/teamStatisticsView.html":'<div class="statisticsView">\n    <div class="filters open" data-dojo-attach-point="filters">\n        <div class="filters-inner">\n            <h3>Filter</h3>\n            <div class="exportForm" data-dojo-attach-point="filterForm" data-dojo-type="dijit/form/Form">\n                <table><tbody>\n                    <tr>\n                        <td>Projekt:</td>\n                        <td>\n                            <div data-dojo-attach-point="projectChooserContainer"\n                                 data-dojo-type="dijit/layout/ContentPane"></div>\n                        </td>\n                    </tr>\n                    <tr>\n                        <td>Zeitraum:</td>\n                        <td>\n                            <input type="text"\n                                name="start"\n                                class="date"\n                                data-dojo-type="phpr/DateTextBox"\n                                data-dojo-attach-point="startDate"\n                                data-dojo-props="placeholder:\'Start date\', value: \'firstOfMonth\'" />\n                            -\n                            <input type="text"\n                                name="end"\n                                class="date"\n                                data-dojo-type="phpr/DateTextBox"\n                                data-dojo-attach-point="endDate"\n                                data-dojo-props="placeholder:\'End date\', value: \'lastOfMonth\'" />\n                        </td>\n                    </tr>\n                    <tr>\n                        <td></td>\n                        <td>\n                            <button data-dojo-type="dijit/form/Button"\n                                type="submit"\n                                data-dojo-attach-point="exportButton"\n                                data-dojo-props="baseClass:\'submitButton\'">Export to CSV</button>\n                        </td>\n                    </tr>\n                </tbody></table>\n            </div>\n        </div>\n    </div>\n    <div data-dojo-attach-point="tableContainer" data-dojo-type="dijit/layout/ContentPane">\n    </div>\n</div>\n'}});
define("phpr/TeamStatisticsView","dojo/_base/declare,dojo/_base/lang,dojo/_base/array,dojo/dom-construct,dojo/promise/all,dojo/Deferred,dojo/on,dijit/_Widget,dijit/_TemplatedMixin,dijit/_WidgetsInTemplateMixin,dojo/text!phpr/template/teamStatisticsView.html,phpr/ProjectChooser,phpr/models/Project,phpr/Statistics/ProjectBookingsTable,phpr/models/Timecard,dijit/layout/ContentPane".split(","),function(d,b,r,f,g,h,c,i,j,k,l,m,n,o,p){var q=d([m],{createOptions:function(a){var b=new h,c=[];this.first=null;
for(var d in a.projects){if(null===this.first)this.first=a.projects[d];var e=a.projects[d];c.push({id:""+e.id,name:""+e.id+" "+e.title,label:'<span class="projectId">'+e.id+"</span> "+e.title})}b.resolve(c);return b},getData:function(){return g({projects:n.getManagedProjects()})},postStoreSet:function(){null!==this.first&&this.set("value",""+this.first.id)}});return d([i,j,k],{templateString:l,_tableUpdateTimer:null,buildRendering:function(){this.inherited(arguments);this.projectChooser=new q({},
f.create("select"));this.projectChooserContainer.set("content",this.projectChooser);this.own(c(this.projectChooser,"change",b.hitch(this,"_updateTableWidget")));this.own(c(this.startDate,"change",b.hitch(this,"_updateTableWidget")));this.own(c(this.endDate,"change",b.hitch(this,"_updateTableWidget")));this.own(this.exportButton.on("click",b.hitch(this,this._openExport)))},_updateTableWidget:function(){this._scheduleTableWidgetUpdate()},_scheduleTableWidgetUpdate:function(){clearTimeout(this._tableUpdateTimer);
this._tableUpdateTimer=setTimeout(b.hitch(this,function(){this._setTable()}),250)},_setTable:function(){this.tableContainer.set("content",new o(this._getTableParams()))},_getSelectedProjects:function(){var a=this.projectChooser.get("value");return"-1"===a||""===a?[]:[a]},_getTableParams:function(){return{projects:this._getSelectedProjects(),startDate:this.startDate.get("value"),endDate:this.endDate.get("value")}},_openExport:function(a){a&&a.stopPropagation();this.filterForm.validate()&&(a=this._getTableParams(),
a=p.getMemberBookingsCSVUrl({projects:a.projects,start:a.startDate,end:a.endDate}),window.open(a));return!1}})});